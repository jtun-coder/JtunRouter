import{_ as V,k as a,a4 as D,C as M,D as $,ar as N,F as E,o as l,g as i,s as o,J as I,Y as w,x as c,p as R,q as T,a as k,n as U}from"./index-X_y_Lweg.js";/* empty css                   */import{E as F}from"./el-switch-KfUhZLjF.js";import{T as z,V as A,W as q}from"./index-CcVygsTE.js";import{v as G}from"./directive-ByWyyhHJ.js";import"./index-Bh4Knf-X.js";import"./index-CQpVMKCZ.js";import"./constants-C-bldqyn.js";import"./use-form-item-En1b377h.js";import"./request-CUVclgT8.js";const J={class:"OnlineClient mt24"},W={class:"OnlineClientTop"},Y={class:"OnlineLeft"},j=["onClick"],x={class:"OnlineRight"},H={class:"autofresh"},K={class:"SwitchOpen"},P={class:"OnlineClientBottom"},Q={class:"loadingMore"},X={__name:"SystemLog",setup(Z){const d=a(1),u=D();let v=a(0);const C=a([{name:"runlog"},{name:"operationlog"},{name:"Applog"},{name:"Upgradelog"},{name:"Exceptionlog"}]),f=a(!1),g=a(""),m=a(""),n=M({logList:[]});let p=a(!1);const S=e=>{if(!e)return"无效日期";try{const t=typeof e=="string"?parseInt(e):e;return isNaN(t)?(console.error("无效的时间戳:",e),"无效日期"):(t.toString().length===10?new Date(t*1e3):new Date(t)).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return console.error("日期格式化错误:",t),"无效日期"}},_=async e=>{v.value=e-1,console.log(v.value),d.value=e;try{const t=await z({password:u.token,type:d.value,offset:0,limit:100});t.code==0&&(n.logList=t.data,g.value=t.data[0].id,m.value=t.data[t.data.length-1].id)}catch(t){console.log(t)}finally{p.value=!1}},y=async()=>{const e=await A({id:g.value,password:u.token,type:d.value,limit:100});n.logList=[...e.data,...n.logList],g.value=e.data[0].id},B=async()=>{console.log(g.value);try{const e=await q({password:u.token,type:d.value,id:m.value,limit:100});e.code==0&&(n.logList=[...n.logList,...e.data],m.value=e.data[e.data.length-1].id)}catch(e){console.log(e)}finally{p.value=!1}};let h;return $(f,e=>{e?h=setInterval(()=>{y()},1e3):clearInterval(h)}),N(()=>{clearInterval(h)}),E(()=>{_(1)}),(e,t)=>{const L=F,O=G;return l(),i("div",null,[o("div",J,[o("div",W,[o("div",Y,[(l(!0),i(I,null,w(C.value,(s,r)=>(l(),i("div",{key:r,class:U({OnlineItem:!0,activeOnlineItem:k(v)==r}),onClick:b=>_(r+1)},c(e.$t(`log.${s.name}`)),11,j))),128))]),o("div",x,[o("div",H,[o("div",K,c(e.$t("log.Autorefresh")),1),R(L,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),"active-color":"#06F","inactive-color":"#ff4949"},null,8,["modelValue"])]),o("div",{class:"refreshButton",onClick:y},c(e.$t("log.refresh")),1)])]),T((l(),i("div",P,[(l(!0),i(I,null,w(n.logList,(s,r)=>(l(),i("p",{key:r,class:"logItem"},c(S(s.time)+" "+s.tag+" "+s.msg),1))),128))])),[[O,k(p)]]),o("div",Q,[o("div",{class:"ViewMore",onClick:B},c(e.$t("log.ViewMore")),1)])])])}}},de=V(X,[["__scopeId","data-v-6ad4f192"]]);export{de as default};
