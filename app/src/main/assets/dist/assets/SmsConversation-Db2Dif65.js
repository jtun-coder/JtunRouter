import{_ as ce,X as ue,a4 as he,k as c,C as N,F as ve,D as G,o as n,g as i,a as l,s as e,x as a,p as d,w as u,J as A,Y as U,S as B,Z as V,y as b,a7 as Z,c as pe,n as F,P as W,$ as ge,a0 as _e}from"./index-X_y_Lweg.js";import{E as me}from"./el-input-CNB75vlJ.js";import{E as fe,a as ke}from"./el-col-BD9sDvtY.js";import{E as ye}from"./el-checkbox-h2JTCBT1.js";import{M as Se,N as J,O as Q,P as Me,Q as we}from"./index-CcVygsTE.js";import{E as p}from"./index-r5B_-fV1.js";import{E as X}from"./index-C_xjvvip.js";import"./index-C2mSDKPv.js";import"./index-Bh4Knf-X.js";import"./index-CQpVMKCZ.js";import"./typescript-Bp3YSIOJ.js";import"./constants-C-bldqyn.js";import"./use-form-item-En1b377h.js";import"./isEqual-DcOtnrVm.js";import"./index-D-QKPCnM.js";import"./request-CUVclgT8.js";import"./aria-BUADUvnR.js";import"./directive-ByWyyhHJ.js";const Y="/assets/Arrow-left-CEOw6kwz.png",Ce=L=>(ge("data-v-4d2d4ad1"),L=L(),_e(),L),Ie={key:0},Be={class:"OnlineClient mt24"},Ve={class:"OnlineClientTop"},Fe={class:"OnlineHeader"},Le={class:"headerLeft"},Te={class:"HeadBottom"},$e={class:"buttonBlock"},xe={class:"OnlineBody"},De={style:{overflow:"auto"}},He={class:"WifiTable"},be={class:"WifiHeader"},Ee={class:"HeaderItem"},Oe={class:"HeaderItem"},Re={class:"HeaderItem"},Ne={class:"HeaderItem"},Ae={class:"WifiBody"},Ue={key:0,class:"Nodata"},je={key:1},Pe={class:"BodyItem"},ze={class:"BodyItemGroup"},Ge={key:0,class:"BlueDot"},We={class:"BodyItem3"},Je={class:"BodyItem"},Qe={class:"BodyItemGroup"},Xe={class:"BodyItem3"},Ye=Ce(()=>e("br",null,null,-1)),Ze={key:1},qe={class:"OnlineClient mt24"},Ke={class:"OnlineClientTop"},es={class:"OnlineHeader"},ss={class:"headerLeft"},ts={class:"smalltext"},os={class:"FileBody"},as={class:"FileTop"},ls=["src"],ds={class:"rightInput"},ns={class:"messageTime"},is={key:0,class:"BlueDot"},rs={class:"contentBlock"},cs={class:"InputMessage"},us={class:"InputMessageUp"},hs=Z('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" data-v-4d2d4ad1><path d="M14.6668 8V3H8.00016H1.3335V8V13H8.00016" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M14.6667 11.333H10" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M13 9.66699L14.6667 11.3337L13 13.0003" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M1.3335 3L8.00016 8L14.6668 3" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path></svg>',1),vs={class:"InputMessageDown"},ps={key:2},gs={class:"OnlineClient mt24"},_s={class:"OnlineClientTop"},ms={class:"OnlineHeader"},fs={class:"headerLeft"},ks={class:"smalltext"},ys={class:"FileBody"},Ss={class:"FileTop"},Ms=["src"],ws={class:"rightInput"},Cs={class:"messageTime"},Is={key:0,class:"BlueDot"},Bs={class:"contentBlock"},Vs={class:"InputMessage"},Fs={class:"InputMessageUp"},Ls=Z('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" data-v-4d2d4ad1><path d="M14.6668 8V3H8.00016H1.3335V8V13H8.00016" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M14.6667 11.333H10" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M13 9.66699L14.6667 11.3337L13 13.0003" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path><path d="M1.3335 3L8.00016 8L14.6668 3" stroke="#0066FF" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" data-v-4d2d4ad1></path></svg>',1),Ts={class:"InputMessageDown"},$s={__name:"SmsConversation",setup(L){ue();const g=he();let _=c(!0),m=N([]),f=c(!1);const T=c(null);let k=c(!1),y=c(""),S=c(""),$=N([]),x=c(null),M=c(!1),h=c(""),w=c(""),C=N([]),j=c(!1);ve(()=>{E()});const E=async()=>{try{const s=await Se({password:g.token});m.splice(0,m.length,...s.data),m.forEach(t=>{t.ischeck=f.value})}catch(s){console.log(s)}},q=()=>{k.value=!1,M.value=!0,_.value=!1},O=s=>{if(!s)return"无效日期";try{const t=typeof s=="string"?parseInt(s):s;return isNaN(t)?(console.error("无效的时间戳:",s),"无效日期"):(t.toString().length===10?new Date(t*1e3):new Date(t)).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return console.error("日期格式化错误:",t),"无效日期"}},K=async()=>{if(S.value.trim()==""){p({message:"please enter something",type:"warning"});return}X.service({lock:!0,text:"Sending...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"});try{(await J({password:g.token,address:y.value,body:S.value})).code==0&&setTimeout(()=>{S.value=="",P(y.value)},3e3)}catch{p({type:"error",message:"send error"})}finally{X.service().close()}},P=async s=>{try{const t=await Q({password:g.token,address:s});$.splice(0,$.length,...t.data.reverse())}catch(t){console.log(t)}},ee=async s=>{try{await we({password:g.token,threadId:s})}catch(t){console.log(t)}},R=async s=>{console.log(s),y.value=s.address,k.value=!0,M.value=!1,_.value=!1,s.lastMessage.read==0&&ee(s.threadId),P(s.address)},se=async s=>{try{const t=await Q({password:g.token,address:s});t.code==0&&(C.splice(0,C.length,...t.data.reverse()),console.log(C))}catch(t){console.log(t)}},te=async()=>{if(!/^([0-9]|\+|#|\*){3,20}$/.test(h.value)){p({type:"warning",message:"Please enter the correct phone number"});return}if(w.value.trim()==""){p({type:"warning",message:"Please enter the content"});return}console.log(h.value),console.log(w.value);try{(await J({password:g.token,address:h.value,body:w.value})).code==0&&(p({type:"success",message:"Sending SMS successfully"}),setTimeout(()=>{se(h.value)},3e3))}catch(t){console.log(t)}},oe=()=>{C=[],j.value=!1,h.value="",k.value=!1,M.value=!1,_.value=!0},ae=()=>{k.value=!1,M.value=!1,_.value=!0,E()},le=()=>{console.log(f.value),m.forEach(s=>{s.ischeck=f.value})},de=async s=>{console.log(s);try{await Me({password:g.token,threadId:s})}catch{p({type:"error",message:"Failed to Delete"})}},ne=async()=>{let s=[];if(m.forEach(v=>{v.ischeck==!0&&s.push(v.threadId)}),s.length==0)return;let t=0;for(const v of s)try{await de(v),t++}catch{p({type:"error",message:"Delete failed"});return}p({type:"success",message:`Successfully deleted ${t} SMS`}),setTimeout(()=>{E()},3e3)};G($,()=>{W(()=>{ie()})});const ie=()=>{T.value&&(T.value.scrollTop=T.value.scrollHeight)};G(C,()=>{W(()=>{re()})});const re=()=>{x.value&&(x.value.scrollTop=x.value.scrollHeight)};return(s,t)=>{const v=ye,r=ke,z=fe,D=me;return n(),i("div",null,[l(_)&&!l(k)&&!l(M)?(n(),i("div",Ie,[e("div",Be,[e("div",Ve,[e("div",Fe,[e("div",Le,a(s.$t("tools.SMSConversation")),1)]),e("div",Te,a(s.$t("tools.SMSTIP1")),1),e("div",$e,[e("div",{class:"CreateMessage",onClick:t[0]||(t[0]=o=>q())},a(s.$t("tools.CreateMessage")),1),e("div",{class:"DeleteMessage",onClick:t[1]||(t[1]=o=>ne())},a(s.$t("tools.Delete")),1)]),e("div",xe,[e("div",De,[e("div",He,[e("div",be,[d(z,{gutter:10},{default:u(()=>[d(r,{lg:3,md:3,sm:3,xl:3,xs:3},{default:u(()=>[e("div",Ee,[d(v,{onChange:le,modelValue:l(f),"onUpdate:modelValue":t[2]||(t[2]=o=>V(f)?f.value=o:f=o)},null,8,["modelValue"])])]),_:1}),d(r,{lg:2,md:2,sm:2,xl:2,xs:2}),d(r,{lg:4,md:4,sm:4,xl:4,xs:4},{default:u(()=>[e("div",Oe,a(s.$t("tools.Contacts")),1)]),_:1}),d(r,{lg:11,md:11,sm:11,xl:11,xs:11},{default:u(()=>[e("div",Re,a(s.$t("tools.Content")),1)]),_:1}),d(r,{lg:4,md:4,sm:4,xl:4,xs:4},{default:u(()=>[e("div",Ne,a(s.$t("tools.Date")),1)]),_:1})]),_:1})]),e("div",Ae,[l(m).length==0?(n(),i("div",Ue,"Nodata")):(n(),i("div",je,[(n(!0),i(A,null,U(l(m),(o,I)=>(n(),pe(z,{gutter:10,class:"RowItem",key:I},{default:u(()=>[d(r,{lg:3,md:3,sm:3,xl:3,xs:3},{default:u(()=>[e("div",Pe,[d(v,{modelValue:o.ischeck,"onUpdate:modelValue":H=>o.ischeck=H},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),d(r,{lg:2,md:2,sm:2,xl:2,xs:2},{default:u(()=>[e("div",null,[e("i",{class:F(["iconfont",o.lastMessage.type==1?"icon-navicon-dxjs":"icon-navicon-dxfs"])},null,2)])]),_:2},1024),d(r,{lg:4,md:4,sm:4,xl:4,xs:4,onClick:H=>R(o)},{default:u(()=>[e("div",ze,[o.lastMessage.read==0?(n(),i("div",Ge)):b("",!0),e("div",We,a(o.address),1)])]),_:2},1032,["onClick"]),d(r,{lg:11,md:11,sm:11,xl:11,xs:11,onClick:H=>R(o)},{default:u(()=>[e("div",Je,a(o.lastMessage.body),1)]),_:2},1032,["onClick"]),d(r,{lg:4,md:4,sm:4,xl:4,xs:4,onClick:H=>R(o)},{default:u(()=>[e("div",Qe,[e("div",Xe,[B(a(O(o.lastMessage.data))+" ",1),Ye])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]))])])])])])])])):l(k)&&!l(M)&&!l(_)?(n(),i("div",Ze,[e("div",qe,[e("div",Ke,[e("div",es,[e("div",ss,a(s.$t("tools.SMSTIP1")),1)]),e("div",ts,a(s.$t("tools.SMSTIP1")),1),e("div",os,[e("div",as,[e("div",{class:"leftBack",onClick:ae},[e("img",{src:l(Y),alt:""},null,8,ls),B(" "+a(s.$t("tools.back")),1)]),e("div",ds,[d(D,{class:"inputDeep2",modelValue:l(y),"onUpdate:modelValue":t[3]||(t[3]=o=>V(y)?y.value=o:y=o),readonly:""},null,8,["modelValue"])])]),e("div",{class:"messageBody",ref_key:"messageContainer",ref:T},[(n(!0),i(A,null,U(l($),(o,I)=>(n(),i("div",{class:"MessageItem",key:I},[e("div",{class:F(o.type==1?"StartRight":"StartLeft")},[e("div",ns,a(O(o.data)),1),e("div",{class:F(o.type==1?"messageContentRight":"messageContent")},[o.read==0?(n(),i("div",is)):b("",!0),e("div",rs,a(o.body),1)],2)],2)]))),128))],512),e("div",cs,[e("div",us,[e("div",null,a(s.$t("tools.InputMessage")),1),e("div",{class:"SendRight",onClick:K},[hs,B("  "+a(s.$t("tools.Send")),1)])]),e("div",vs,[d(D,{maxlength:"70",class:"inputDeep",modelValue:l(S),"onUpdate:modelValue":t[4]||(t[4]=o=>V(S)?S.value=o:S=o)},null,8,["modelValue"])])])])])])])):l(M)&&!l(k)&&!l(_)?(n(),i("div",ps,[e("div",gs,[e("div",_s,[e("div",ms,[e("div",fs,a(s.$t("tools.SMSTIP1")),1)]),e("div",ks,a(s.$t("tools.SMSTIP1")),1),e("div",ys,[e("div",Ss,[e("div",{class:"leftBack",onClick:oe},[e("img",{src:l(Y),alt:""},null,8,Ms),B(" "+a(s.$t("tools.back")),1)]),e("div",ws,[d(D,{class:"inputDeep",placeholder:s.$t("tools.SMStip2"),readonly:l(j),modelValue:l(h),"onUpdate:modelValue":t[5]||(t[5]=o=>V(h)?h.value=o:h=o)},null,8,["placeholder","readonly","modelValue"])])]),e("div",{class:"messageBody",ref_key:"addMessageBody",ref:x},[(n(!0),i(A,null,U(l(C),(o,I)=>(n(),i("div",{class:"MessageItem",key:I},[e("div",{class:F(o.type==1?"StartRight":"StartLeft")},[e("div",Cs,a(O(o.data)),1),e("div",{class:F(o.type==1?"messageContentRight":"messageContent")},[o.read==0?(n(),i("div",Is)):b("",!0),e("div",Bs,a(o.body),1)],2)],2)]))),128))],512),e("div",Vs,[e("div",Fs,[e("div",null,a(s.$t("tools.InputMessage")),1),e("div",{class:"SendRight",onClick:te},[Ls,B("  "+a(s.$t("tools.Send")),1)])]),e("div",Ts,[d(D,{maxlength:"70",placeholder:s.$t("tools.SMStip3"),class:"inputDeep",modelValue:l(w),"onUpdate:modelValue":t[6]||(t[6]=o=>V(w)?w.value=o:w=o)},null,8,["placeholder","modelValue"])])])])])])])):b("",!0)])}}},Ys=ce($s,[["__scopeId","data-v-4d2d4ad1"]]);export{Ys as default};
